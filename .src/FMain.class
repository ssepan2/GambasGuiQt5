' Gambas class file

'
' Private
'
Private controller As Controller
Private model As SomeModel

Private Sub Close()
  
  Me.Close
  
End

Private Sub FileNew()
    Dim errorMessage As String
    StatusLabel.Text = "Starting New..."
    StatusPictureBox.Picture = ToolButtonFileNew.Picture
    StatusProgressBar.Value = 0.5

    If controller.FileNew(ByRef errorMessage)
        StatusLabel.Text = "Finished New."
        StatusProgressBar.Value = 1
        Wait 1
    Else
        StatusLabel.Text = errorMessage '"Error on New!"
    Endif
    StatusProgressBar.Value = 0
    StatusPictureBox.Picture = Null
End

Private Sub FileOpen()
    Dim errorMessage As String
    StatusLabel.Text = "Starting Open..."
    StatusPictureBox.Picture = ToolButtonFileOpen.Picture
    StatusProgressBar.Value = 0.5

    If controller.FileOpen(ByRef errorMessage)
        StatusLabel.Text = "Finished Open."
        StatusProgressBar.Value = 1
        Wait 1
    Else
        StatusLabel.Text = errorMessage '"Error on Open!"
    Endif
    StatusProgressBar.Value = 0
    StatusPictureBox.Picture = Null
End

Private Sub FileSave()
    Dim errorMessage As String
    StatusLabel.Text = "Starting FileSave..."
    StatusPictureBox.Picture = ToolButtonFileSave.Picture
    StatusProgressBar.Value = 0.5

    If controller.FileSave(ByRef errorMessage)
        StatusLabel.Text = "Finished FileSave."
        StatusProgressBar.Value = 1
        Wait 1
    Else
        StatusLabel.Text = errorMessage '"Error on FileSave!"
    Endif
    StatusProgressBar.Value = 0
    StatusPictureBox.Picture = Null
End

Private Sub FileSaveAs()
    Dim errorMessage As String
    StatusLabel.Text = "Starting FileSaveAs..."
    StatusPictureBox.Picture = ToolButtonFileSaveAs.Picture
    StatusProgressBar.Value = 0.5

    If controller.FileSaveAs(ByRef errorMessage)
        StatusLabel.Text = "Finished FileSaveAs."
        StatusProgressBar.Value = 1
        Wait 1
    Else
        StatusLabel.Text = errorMessage '"Error on FileSaveAs!"
    Endif
    StatusProgressBar.Value = 0
    StatusPictureBox.Picture = Null
End

'
' Form
'
Public Sub Form_Open()
    StartController
    'TODO:StartModel or FileNew
End

Public Sub Form_Close()

    model = Null
    controller = Null

End

Private Sub StartController()
   Dim Result As String
 
    StatusLabel.Text = "Starting controller..."
    StatusPictureBox.Picture = ToolButtonFileNew.Picture
    StatusProgressBar.Value = 0.33
    Try controller = New Controller
        Result = "Finished controller."
        StatusProgressBar.Value = 1
    Finally
        StatusLabel.Text = Result
        Wait 1
        StatusProgressBar.Value = 0
        StatusPictureBox.Picture = Null
    Catch
        Result = "Error on controller!"
End


Public Sub UpdateForm()
    
    'Me.SomeStringTextBox.text = x
    'Me.SomeIntegerValueBox.value = x
    'Me.SomeBooleanCheckBox.Value = x
    
End


'
' Menu
'
Public Sub MenuFileNew_Click()
    FileNew
End

Public Sub MenuFileOpen_Click()
    FileOpen
End

Public Sub MenuFileSave_Click()
    FileSave
End

Public Sub MenuFileSaveAs_Click()
    FileSaveAs
End

Public Sub MenuFileExit_Click()

  Close()

End

Public Sub MenuHelpAbout_Click()

  StatusLabel.Text = ("MenuHelpAbout_Click")
  Message("About...")

End

'
' Toolbar
'
Public Sub ToolButtonFileNew_Click()
    FileNew
End

Public Sub ToolButtonFileOpen_Click()
    FileOpen
End

Public Sub ToolButtonFileSave_Click()
    FileSave
End

Public Sub ToolButtonFileSaveAs_Click()
    FileSaveAs
End

'
' Controls
'
Public Sub ButtonClose_Click()

  Close()

End


Public Sub SomeStringTextBox_Change()

    'x=SomeStringTextBox.text

End

Public Sub SomeIntegerValueBox_Change()

    ' x=SomeIntegerValueBox.Value

End

Public Sub SomeBooleanCheckBox_Click()

    ' x=SomeBooleanCheckBox.Value

End
