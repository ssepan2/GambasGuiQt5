' Gambas class file

Class ModelBase
' #Region "INotifyPropertyChanged"
Event PropertyChanged(propertyName As String) 'As Boolean

Public Sub NotifyPropertyChanged(propertyName As String)

    Dim bResult As Boolean = False

    Debug "PropertyChanged fired: " & propertyName
    bResult = Raise PropertyChanged(propertyName) 'As BResult
    ' Debug bResult
    If bResult Then
        Debug "PropertyChanged cancelled: " & propertyName
    Endif
Catch
    Debug Log.FormatError
    Debug Error.text

End 'Sub
' #End Region

'
'Properties
'
Private $sKey As String
Property Key As String

Private Function Key_Read() As String

    Return $sKey

End

Private Sub Key_Write(Value As String)

    If $sKey <> Value Then
        $sKey = Value
        Me.Dirty = True
        NotifyPropertyChanged("Key")
    Endif

End

Private $bDirty As Boolean = False
Property Dirty As Boolean

Private Function Dirty_Read() As Boolean

    Return $bDirty

End

Private Sub Dirty_Write(Value As Boolean)

    $bDirty = Value
    NotifyPropertyChanged("Dirty")

End

'
'Methods
'
